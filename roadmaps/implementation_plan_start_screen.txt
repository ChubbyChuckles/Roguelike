START SCREEN IMPLEMENTATION PLAN (Roadmap & Status)

Legend:
Done = Fully implemented & tests pass (or empirically verified in runtime)
Partial = Some components implemented (details in parentheses)
X = Not started yet

Scope Overview:
A polished, performant, and accessible start screen that integrates tightly with the existing UI system. Goals: deterministic/headless testability, controller-friendly navigation, theming and reduced-motion compliance, fast startup with async prewarming, clean transitions to Game/New/Load/Settings/Credits, and graceful degradation when optional subsystems (e.g., SDL2_mixer) are unavailable. All UI state is snapshot-able for regression and replay testing.

PHASE 0. Current Baseline (Partial)
0.1 Simple start menu exists (per UI roadmap 0.4) (Done)
0.2 Core UI architecture, focus model, theming, reduced motion, animation/timeline, headless harness (Done)
0.3 Persistence artifacts present (e.g., save_slot_0.sav) (Partial: header/thumbnail plumbing TBD)
0.4 Audio optional; SDL2_mixer not guaranteed (Partial: warnings in CMake, plan for silent fallback)

PHASE 1. State Flow & Controller
1.1 StartScreenState enum + app state registration (Done)
1.2 Entry/exit transitions (fade logo, crossfade to menu) using existing timeline APIs (Done)
1.3 Input routing: keyboard/mouse/controller, focus ring, activation (Done: reuse UI Phase 3 foundations)
1.4 Deterministic RNG channel scoped to start screen (Done: reuse UI RNG; seed salt "start")
1.5 Reduced motion gate on transitions (Done: respect global flag)

PHASE 2. Visual Identity & Background Image
2.1 Static background image support (e.g., assets/ui/start_bg.png), overridable via theme or cfg (Done)
2.2 Image loading via SDL2_image with graceful fallback when library/image is missing (Done: uses RogueTexture loader; gradient fallback on absence)
2.3 Scaling modes: cover (default), contain, or auto; aspect-ratio aware crop/letterbox; high-DPI (Done: cover/contain implemented; auto reserved)
2.4 Color overlay/tint to match theme; brightness clamp for contrast/accessibility (Done: ARGB tint applied with max channel clamp to 240)
2.5 Parallax sprite layers (stars/particles) optional on top; reduced-motion unaffected (Done)
2.6 Background gradient fallback when no image or on low-asset mode (Done)
2.7 Logo lockup with safe-area layout (Done)
2.8 Optional shader bloom/scanline pass with CPU fallback (X)
2.9 Day/Night tint driven by system time or seed (Done: sine-wave time modulation)

PHASE 3. Main Menu Structure
3.1 Menu items: Continue (if saves), New Game, Load Game, Settings, Credits, Quit (Done: disabled handling; Settings/Credits placeholders; Continue/Load target most recent slot)
3.2 Controller navigation with axis repeat; wrap-around, disabled items skipped (Done: held Up/Down repeat with initial delay and interval; wrap-around + disabled-skip)
3.3 Tooltips: right panel shows description/hints; narration stub emits labels (Done)
3.4 Hotkeys: Enter/Space accept, Esc/Back cancel, first-letter accelerators (Done)
3.5 Localization-ready labels (en-US strings table placeholder) (Partial: base en-US keys added; loader remains minimal)

PHASE 4. Continue/Load Integration
4.1 Save discovery: enumerate available slots; show most recent (Done)
4.2 Save header reader: name, playtime, area, timestamp; handle corrupted files (Done: rogue_save_read_descriptor())
4.3 Thumbnail placeholder (initials or seed-based color) (Done: seeded color block + border)
4.4 Continue action: boot most recent save -> transition to game state (Done: loads most recent and triggers fade out)
4.5 Load screen: list with scroll & virtualization for many saves (Partial: basic list with wrap navigation for up to ROGUE_SAVE_SLOT_COUNT; no virtualization yet)
4.6 Delete confirmation modal with risk wording (Done)

PHASE 5. New Game Flow
5.1 Difficulty/Mode selection stub (Normal) (X)
5.2 Seed entry/Randomize controls (optional) (X)
5.3 Confirmation modal -> creates initial save + transitions (X)
5.4 Telemetry event: new_game_start with seed/difficulty (X)

PHASE 6. Settings & Accessibility Entrypoints
6.1 Open settings screen (graphics, audio, controls) placeholder panels (X)
6.2 Accessibility toggles: high contrast, reduced motion, narration (X; backed by existing flags)
6.3 DPI/UI scale quick adjust (X; uses existing scaling API)

PHASE 7. Credits & Legal
7.1 Credits viewer with scroll inertia; Markdown->layout minimal (X)
7.2 Licenses page (SDL2, fonts, assets) (X)
7.3 Build/version hash and git branch display (X)

PHASE 8. Async Prewarm & Performance
8.1 Background asset prewarm (glyph cache bootstrap, theme cache, background image decode/texture upload) (X)
8.2 Optional audio BGM start with graceful fallback if mixer missing (X)
8.3 Frame budget guard: keep update+render < 1.0ms on baseline (X)
8.4 Loading spinner micro-state when async jobs run (X)

PHASE 9. Transitions to/from Game
9.1 Transition out: fade menu -> fade in world HUD (X)
9.2 Escape back to start screen from main menu (dev toggle) (X)
9.3 Safety: cancel running transitions cleanly on state change (X)

PHASE 10. Testing & QA Automation
10.1 Headless golden snapshot: start screen first frame hash (Verified Debug: test_start_screen_phase10_1_headless)
10.2 Navigation traversal test: keyboard & controller (Verified Debug: test_start_screen_phase10_2_navigation)
10.3 Localization swap test: label table (en) -> (fake-locale) (Verified Debug: test_start_screen_phase10_3_localization)
10.4 Reduced motion test: transitions skipped, hashes stable (Verified Debug: test_start_screen_phase10_4_reduced_motion)
10.5 Performance smoke: emit >=200 widgets < threshold time (X)
10.6 Corrupt save header test: continue disabled, load lists only healthy entries (Done: Verified Debug: test_start_screen_phase10_6_corrupt_header)
10.7 Background image presence: renders when file exists; falls back to gradient when missing (Done)
10.8 Aspect-ratio scaling: hash differs for cover vs contain; no stretching artifacts (Done)
10.9 SDL2_image absent: harness simulates missing loader -> no crash; gradient path validated (Done)

Verification notes (2025-08-26):
- Built Debug with SDL2, parallel 8. Start screen test suite passed (4/4).
- Manual smoke: Load list overlay opens, navigates across existing slots; selecting loads and transitions via fade-out.
- Full test run: 95% passed; remaining failures in unrelated AI/combat/worldgen/equipment suites. test_boot passed on re-run; no start screen regressions observed.
 - Logging tightened: default WARN reduces console spam; ROGUE_LOG_LEVEL env enables opt-in DEBUG/INFO for troubleshooting.
 - Load overlay now includes a delete confirmation modal. Confirm (Enter) deletes the selected slot via save manager API; cancel (Esc) aborts. Save manager tolerates missing sidecar files.

Additional verification (2025-08-26, later run):
- Rebuilt Debug with SDL2 (-j8). Start screen Phase 10 suite passed (5/5), including 10.6 corrupt header.
- Continue/Load paths now re-validate save headers immediately before attempting load; corrupt/incompatible headers are ignored and do not trigger fade-out.

PHASE 11. Telemetry & Analytics (Optional)
11.1 Menu selection event stream with session id (X)
11.2 A/B flag hook for background variant (static vs animated) (X)

DEPENDENCIES / RISKS
- SDL2_image/mixer may be absent; must degrade gracefully (no crashes, muted audio). Background image specifically relies on SDL2_image; fallback to gradient if unavailable.
- Large save directories require virtualization; ensure smooth scroll and discovery latency < 100ms.
- Localization table not yet present; introduce minimal key->string mechanism with safe fallback to keys.

SUCCESS METRICS
- Deterministic headless hash stable across runs and platforms (within CI matrix).
- Navigation traversal has zero focus traps (keyboard + controller).
- Start screen idle CPU time < 0.5 ms per frame on baseline; memory stable (no leaks).
- Time-to-interactive < 500 ms after process start (assuming caches present).

NEXT ACTION CANDIDATES (If starting now)
- Add 10.1 headless golden test and 10.2 traversal test; wire reduced-motion gating.
- Extend menu wiring for controller repeat (3.2), tooltips (3.3), and hotkeys (3.4).
- Document background asset override path in README and add design notes on tint/clamp.

CROSS-SYSTEM SYNERGIES
- UI: reuse theme, animation/timeline, focus, headless harness, virtualization for save lists.
- Persistence: read-only save headers; integrate with snapshot serializer for continue/load.
- Audio: optional BGM with silent fallback; SFX on focus/accept.
- Analytics: use existing event/logger infra (if present in project) or stub in test-only.

OPEN TASKS
- Define strings table format and loader (en-US to start).
- Decide on background shader approach or CPU fallback implementation.
- Add minimal save header struct and reader API.
- Add default start_bg.png (resolution, licensing) and document theme override path.
