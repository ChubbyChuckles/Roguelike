Inventory System Phase 3.3-3.5: Implemented auto-tag rule engine (rarity/category predicates) with deterministic application on first pickup, added accent color support (first matching rule precedence), persisted rules via new save component id=11 (inv_tag_rules), integrated rule application hook into pickup registration, added unit test `test_inventory_phase3_rules` (rule persistence & basic application), updated roadmap (3.3-3.5 Done, 3.6 partial), expanded README inventory section, and wired build (CMake) + save manager registrations.
Inventory System Phase 3.6: Completed enforcement & determinism tests. Added salvage/drop lock check into `inventory_ui` (returns early if locked/favorite). Added `test_inventory_phase3_lock_rule_enforce` verifying locked/favorite prevent salvage & drop (-3 code) and that rule order yields both tags with first color precedence. Roadmap updated (3.6 Done).
Inventory System Phase 4.1-4.3,4.2,4.7 (partial): Implemented query expression parser (AND/OR, predicates over rarity/qty/tag/equip_slot/affix_weight/quality/durability_pct/category), trigram-based fuzzy text search with lazy index + rebuild API, initial composite sort (single key: rarity, qty, name, category with optional descending), and unit test `test_inventory_phase4_query_sort` covering qty predicate, sort correctness, and fuzzy search invocation. Integrated new sources (`inventory_query.c/.h`) into build, updated roadmap marking 4.2 Done and 4.1/4.3/4.7 Partial, and expanded README with Phase 4 progress. Future work: multi-key stable chain, saved searches & quick action bar, incremental mutation re-index hooks, query result caching with LRU, fuzz & perf tests.
Inventory System Phase 4.3,4.4,4.7 (second wave partial): Extended composite sorting to multi-key chain (reverse application qsort) with descending markers, implemented saved searches registry (up to 16) with persistence via new save component id=12 (registered in save manager), added tests `test_inventory_phase4_saved_searches` and persistence round-trip `test_inventory_phase4_saved_searches_persist`, and added mutation hook API for future incremental fuzzy index updates. Updated roadmap (4.3 refined Partial, 4.4 Partial with persistence Done aspect, 4.5 hook noted, 4.7 expanded tests), updated README Phase 4 paragraph. Pending: UI quick action integration, stable secondary ordering guarantee, result cache & LRU (4.6), parser fuzz + leak/perf harness, and wiring mutation hook into item affix/quality/durability change paths.
Inventory System Phase 4.5-4.6,4.7 (third wave partial): Implemented incremental mutation wiring (quantity & instance changes) invalidating trigram dirty bits and query cache; added LRU query result cache (32 entries) with execute_cached API and full invalidation strategy; integrated cache invalidation into pickup/remove paths; added test `test_inventory_phase4_query_cache`; roadmap updated (4.5 Partial, 4.6 Done, 4.7 updated), README Phase 4 paragraph expanded. Pending: UI quick action bar for saved searches, stable secondary ordering improvements, parser fuzz harness, cache hit ratio & leak/perf guard tests.
Inventory System Phase 4.3 completion & 4.1/4.4/4.7 enhancements: Replaced reverse-pass qsort with stable multi-key decorator sort (rarity, qty, name, category; descending `-key`); added saved search quick-apply helper and cache stats (hits/misses) + reset APIs; introduced parser diagnostics hook (`rogue_inventory_query_last_error` placeholder) and cache stats exposure; updated roadmap (4.3 Done, 4.7 Partial note, parser diagnostics mention), README Phase 4 paragraph; header/API additions (cache stats, saved search apply). Pending: fuzz harness, UI quick action bar binding, cache hit ratio assertion test, leak/perf guards, richer parser error messages.
